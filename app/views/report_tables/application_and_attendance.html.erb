<form action="application_and_attendance" name="filter">
  <table border="0" cellspacing="0" cellpadding="0" width="95%" align="center">
    <tr>
      <td width="86%" height="21" align="center" bgcolor="#999999"><b><font color="#FFFFFF">MAKLUMAT PERMOHONAN DAN KEHADIRAN KURSUS </font></b></td>
    </tr>
  </table>
  <br/>
  <table width="90%" border="0" align="center" cellpadding="0" cellspacing="0">
    <tr>
      <td align="center"> Dari: &nbsp;
        <%= select_tag :month_from, options_for_select([["-pilih Bulan-", ""]]+ @planning_months, params[:month_from])%>
        &nbsp;&nbsp;Hingga: &nbsp;
        <%= select_tag :month_until, options_for_select([["-pilih Bulan-", ""]]+ @planning_months, params[:month_until])%>
        &nbsp;&nbsp;Tahun: &nbsp;
        <%= select_tag :year, options_for_select([["-pilih Tahun-", ""]]+ @planning_years, params[:year])%>
        <input type="button" value="Cari" onclick="document.forms[0].submit()">
    </tr>
  </table>
</form>
<br>
<table width="95%" border="0" align="center" cellpadding="2" cellspacing="1" bgcolor="#777777">
  <tr bgcolor="#999999" id="pisang" onclick="">
    <td width="3%" align="center"><font color="#FFFFFF"><strong>No</strong></font></td>
    <td width="7%" align="left"><font color="#FFFFFF">&nbsp;<strong>Kod</strong></font></td>
    <td width="60%" align="left"><font color="#FFFFFF">&nbsp;<strong>Nama Kursus</strong></font></td>
    <td width="10%" align="center"><font color="#FFFFFF">&nbsp;<strong>Jum Permohonan</strong></font></td>
    <td width="10%" align="center"><font color="#FFFFFF">&nbsp;<strong>Jum Dipilih</strong></font></td>
    <td width="10%" align="center"><font color="#FFFFFF">&nbsp;<strong>Jum Hadir</strong></font></td>
  </tr>
  <%if @reports.any? %>
    <%
    total_pemohon = 0
    total_dipilih = 0
    total_hadir = 0
  %>
    <% @reports.each_with_index do |report, index| %>
      <%  bgclr = cycle('#FFFFFF', '#CCCCFF') %>
      <tr bgcolor="<%=bgclr%>" onmouseover="this.style.background='#FFFFCC'" onmouseout="this.style.background='<%=bgclr%>'">
        <td align="center" id="name<%=h report.id %>"><%= (index+1).to_s %>.</td>
        <td align="left"><%=report.code%></td>
        <td align="left"><%=report.course_name%></td>
        <td align="center"><%=report.pemohon %></td>
        <td align="center"><%=report.dipilih %></td>
        <td align="center"><%=report.hadir %></td>
      </tr>
    <%
    total_pemohon += report.pemohon.to_i
    total_dipilih += report.dipilih.to_i
    total_hadir += report.hadir.to_i
    %>
    <% end %>
    <tr bgcolor="#fff">
      <td align="right" colspan="3">Jumlah Keseluruhan</td>
      <td align="center"><%=total_pemohon %></td>
      <td align="center"><%=total_dipilih %></td>
      <td align="center"><%=total_hadir %></td>
    </tr>
  <% end %>
</table>
<br/>
<div align=center>
<%#= will_paginate @reports %>
</div>
<!-- @reports.course_name -->
<!-- @reports.collect(&:pemohon) -->
<!-- @reports.collect(&:dipilih) -->
<!-- @reports.collect(&:hadir) -->
<% 
  @categories = @reports.collect(&:course_name)
  pemohon = Hash["name", "Jml Pemohon", "data", @reports.collect(&:pemohon).collect{|el| el.to_i}]
  dipilih = Hash["name", "Jml Dipilih", "data", @reports.collect(&:dipilih).collect{|el| el.to_i}]
  hadir = Hash["name", "Jml Hadir", "data", @reports.collect(&:hadir).collect{|el| el.to_i}]
  @chart_data = []
  @chart_data << pemohon << dipilih << hadir
  height = total_pemohon.blank? ? 0 : total_pemohon * 5
%>
<% unless @reports.blank?  %>
<div id=table  style="width:95%; height:<%= height %>px;"> something </div>
<%= javascript_include_tag "highcharts" %>
  <%= render :partial => 'shared/chart_bar', 
             :locals => {:chart_title => 'MAKLUMAT PERMOHONAN DAN KEHADIRAN KURSUS', 
  	                   :chart_container => 'table',
  	                   :chart_categories => @categories,
  	                   :chart_data => @chart_data, 
  	                   :size => {'width' => 900, 'height' => 300}}
  	%>	
	
<% end %>